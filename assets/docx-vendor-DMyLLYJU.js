import{p as e,r as t,j as n,b as r,d as a,l as i,a as u,c as o,e as l}from"./vendor-BfqwDkUj.js";function s(e,t){for(var n=0;n<t.length;n++){const r=t[n];if("string"!=typeof r&&!Array.isArray(r))for(const t in r)if("default"!==t&&!(t in e)){const n=Object.getOwnPropertyDescriptor(r,t);n&&Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>r[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function f(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function p(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}),n}var m={},d={},h={},y=t,g=e();h.defer=function(){var e,t,n=new g.Promise(function(n,r){e=n,t=r});return{resolve:e,reject:t,promise:n}},h.when=g.resolve,h.resolve=g.resolve,h.all=g.all,h.props=g.props,h.reject=g.reject,h.promisify=g.promisify,h.mapSeries=g.mapSeries,h.attempt=g.attempt,h.nfcall=function(e){var t=Array.prototype.slice.call(arguments,1);return g.promisify(e).apply(null,t)},g.prototype.fail=g.prototype.caught,g.prototype.also=function(e){return this.then(function(t){var n=y.extend({},t,e(t));return g.props(n)})};var v={},w=t,b=v.types={document:"document",paragraph:"paragraph",run:"run",text:"text",tab:"tab",checkbox:"checkbox",hyperlink:"hyperlink",noteReference:"noteReference",image:"image",note:"note",commentReference:"commentReference",comment:"comment",table:"table",tableRow:"tableRow",tableCell:"tableCell",break:"break",bookmarkStart:"bookmarkStart"},x={baseline:"baseline",superscript:"superscript",subscript:"subscript"};function E(e){this._notes=w.indexBy(e,function(e){return T(e.noteType,e.noteId)})}function T(e,t){return e+"-"+t}function k(e){return{type:b.break,breakType:e}}E.prototype.resolve=function(e){return this.findNoteByKey(T(e.noteType,e.noteId))},E.prototype.findNoteByKey=function(e){return this._notes[e]||null},v.document=v.Document=function(e,t){return{type:b.document,children:e,notes:(t=t||{}).notes||new E({}),comments:t.comments||[]}},v.paragraph=v.Paragraph=function(e,t){var n=(t=t||{}).indent||{};return{type:b.paragraph,children:e,styleId:t.styleId||null,styleName:t.styleName||null,numbering:t.numbering||null,alignment:t.alignment||null,indent:{start:n.start||null,end:n.end||null,firstLine:n.firstLine||null,hanging:n.hanging||null}}},v.run=v.Run=function(e,t){return{type:b.run,children:e,styleId:(t=t||{}).styleId||null,styleName:t.styleName||null,isBold:!!t.isBold,isUnderline:!!t.isUnderline,isItalic:!!t.isItalic,isStrikethrough:!!t.isStrikethrough,isAllCaps:!!t.isAllCaps,isSmallCaps:!!t.isSmallCaps,verticalAlignment:t.verticalAlignment||x.baseline,font:t.font||null,fontSize:t.fontSize||null,highlight:t.highlight||null}},v.text=v.Text=function(e){return{type:b.text,value:e}},v.tab=v.Tab=function(){return{type:b.tab}},v.checkbox=v.Checkbox=function(e){return{type:b.checkbox,checked:e.checked}},v.Hyperlink=function(e,t){return{type:b.hyperlink,children:e,href:t.href,anchor:t.anchor,targetFrame:t.targetFrame}},v.noteReference=v.NoteReference=function(e){return{type:b.noteReference,noteType:e.noteType,noteId:e.noteId}},v.Notes=E,v.Note=function(e){return{type:b.note,noteType:e.noteType,noteId:e.noteId,body:e.body}},v.commentReference=function(e){return{type:b.commentReference,commentId:e.commentId}},v.comment=function(e){return{type:b.comment,commentId:e.commentId,body:e.body,authorName:e.authorName,authorInitials:e.authorInitials}},v.Image=function(e){return{type:b.image,read:function(t){return t?e.readImage(t):e.readImage().then(function(e){return Buffer.from(e)})},readAsArrayBuffer:function(){return e.readImage()},readAsBase64String:function(){return e.readImage("base64")},readAsBuffer:function(){return e.readImage().then(function(e){return Buffer.from(e)})},altText:e.altText,contentType:e.contentType}},v.Table=function(e,t){return{type:b.table,children:e,styleId:(t=t||{}).styleId||null,styleName:t.styleName||null}},v.TableRow=function(e,t){return{type:b.tableRow,children:e,isHeader:(t=t||{}).isHeader||!1}},v.TableCell=function(e,t){return{type:b.tableCell,children:e,colSpan:null==(t=t||{}).colSpan?1:t.colSpan,rowSpan:null==t.rowSpan?1:t.rowSpan}},v.lineBreak=k("line"),v.pageBreak=k("page"),v.columnBreak=k("column"),v.BookmarkStart=function(e){return{type:b.bookmarkStart,name:e.name}},v.verticalAlignment=x;var O={},I=t;function S(e,t){this.value=e,this.messages=t||[]}function N(e){var t=[];return I.flatten(I.pluck(e,"messages"),!0).forEach(function(e){(function(e,t){return void 0!==I.find(e,R.bind(null,t))})(t,e)||t.push(e)}),t}function R(e,t){return e.type===t.type&&e.message===t.message}O.Result=S,O.success=function(e){return new S(e,[])},O.warning=function(e){return{type:"warning",message:e}},O.error=function(e){return{type:"error",message:e.message,error:e}},S.prototype.map=function(e){return new S(e(this.value),this.messages)},S.prototype.flatMap=function(e){var t=e(this.value);return new S(t.value,N([this,t]))},S.prototype.flatMapThen=function(e){var t=this;return e(this.value).then(function(e){return new S(e.value,N([t,e]))})},S.combine=function(e){return new S(I.flatten(I.pluck(e,"value")),N(e))};var B={},P=r,C=n;B.openArrayBuffer=function(e){return C.loadAsync(e).then(function(e){return{exists:function(t){return null!==e.file(t)},read:function(t,n){return e.file(t).async("uint8array").then(function(e){return"base64"===n?P.fromByteArray(e):n?new TextDecoder(n).decode(e):e})},write:function(t,n){e.file(t,n)},toArrayBuffer:function(){return e.generateAsync({type:"arraybuffer"})}}})},B.splitPath=function(e){var t=e.lastIndexOf("/");return-1===t?{dirname:"",basename:e}:{dirname:e.substring(0,t),basename:e.substring(t+1)}},B.joinPath=function(){var e=Array.prototype.filter.call(arguments,function(e){return e}),t=[];return e.forEach(function(e){/^\//.test(e)?t=[e]:t.push(e)}),t.join("/")};var _={},M={},F={},q=t;F.Element=H,F.element=function(e,t,n){return new H(e,t,n)},F.text=function(e){return{type:"text",value:e}};var A=F.emptyElement={first:function(){return null},firstOrEmpty:function(){return A},attributes:{},children:[]};function H(e,t,n){this.type="element",this.name=e,this.attributes=t||{},this.children=n||[]}H.prototype.first=function(e){return q.find(this.children,function(t){return t.name===e})},H.prototype.firstOrEmpty=function(e){return this.first(e)||A},H.prototype.getElementsByTagName=function(e){return D(q.filter(this.children,function(t){return t.name===e}))},H.prototype.text=function(){if(0===this.children.length)return"";if(1!==this.children.length||"text"!==this.children[0].type)throw new Error("Not implemented");return this.children[0].value};var j={getElementsByTagName:function(e){return D(q.flatten(this.map(function(t){return t.getElementsByTagName(e)},!0)))}};function D(e){return q.extend(e,j)}var W={},L={},X=i,U=a;L.parseFromString=function(e){var t=null,n=new X.DOMParser({errorHandler:function(e,n){t={level:e,message:n}}}).parseFromString(e);if(null===t)return n;throw new Error(t.level+": "+t.message)},L.Node=U.Node;var V=h,z=t,Z=L,K=F,$=K.Element;W.readString=function(e,t){t=t||{};try{var n=Z.parseFromString(e,"text/xml")}catch(a){return V.reject(a)}if("parsererror"===n.documentElement.tagName)return V.resolve(new Error(n.documentElement.textContent));function r(e){if(e.namespaceURI){var n=t[e.namespaceURI];return(n?n+":":"{"+e.namespaceURI+"}")+e.localName}return e.localName}return V.resolve(function e(t){switch(t.nodeType){case Y.ELEMENT_NODE:return function(t){var n=r(t),a=[];z.forEach(t.childNodes,function(t){var n=e(t);n&&a.push(n)});var i={};return z.forEach(t.attributes,function(e){i[r(e)]=e.value}),new $(n,i,a)}(t);case Y.TEXT_NODE:return K.text(t.nodeValue)}}(n.documentElement))};var Y=Z.Node,G={},J=t,Q=u;function ee(e,t){e.text(t.value)}G.writeString=function(e,t){var n,r,a=J.invert(t),i={element:function(e,t){var n=e.element(o(t.name),t.attributes);t.children.forEach(function(e){u(n,e)})},text:ee};function u(e,t){return i[t.type](e,t)}function o(e){var t=/^\{(.*)\}(.*)$/.exec(e);if(t){var n=a[t[1]];return n+(""===n?"":":")+t[2]}return e}return n=e,r=Q.create(o(n.name),{version:"1.0",encoding:"UTF-8",standalone:!0}),J.forEach(t,function(e,t){var n="xmlns"+(""===t?"":":"+t);r.attribute(n,e)}),n.children.forEach(function(e){u(r,e)}),r.end()};var te=F;M.Element=te.Element,M.element=te.element,M.emptyElement=te.emptyElement,M.text=te.text,M.readString=W.readString,M.writeString=G.writeString;var ne=t,re=h,ae=M;_.read=ue,_.readXmlFromZipFile=function(e,t){return e.exists(t)?e.read(t,"utf-8").then(oe).then(ue):re.resolve(null)};var ie={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://purl.oclc.org/ooxml/wordprocessingml/main":"w","http://purl.oclc.org/ooxml/officeDocument/relationships":"r","http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing":"wp","http://purl.oclc.org/ooxml/drawingml/main":"a","http://purl.oclc.org/ooxml/drawingml/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","http://schemas.openxmlformats.org/package/2006/relationships":"relationships","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:vml":"v","urn:schemas-microsoft-com:office:word":"office-word","http://schemas.microsoft.com/office/word/2010/wordml":"wordml"};function ue(e){return ae.readString(e,ie).then(function(e){return le(e)[0]})}function oe(e){return e.replace(/^\uFEFF/g,"")}function le(e){return"element"===e.type?"mc:AlternateContent"===e.name?e.firstOrEmpty("mc:Fallback").children:(e.children=ne.flatten(e.children.map(le,!0)),[e]):[e]}var se={},ce={},fe=t;function pe(e,t){return me(function(n){return n.type===e?t(n):n})}function me(e){return function t(n){if(n.children){var r=fe.map(n.children,t);n=fe.extend(n,{children:r})}return e(n)}}function de(e){var t=[];return he(e,function(e){t.push(e)}),t}function he(e,t){e.children&&e.children.forEach(function(e){he(e,t),t(e)})}ce.paragraph=function(e){return pe("paragraph",e)},ce.run=function(e){return pe("run",e)},ce._elements=me,ce._elementsOfType=pe,ce.getDescendantsOfType=function(e,t){return de(e).filter(function(e){return e.type===t})},ce.getDescendants=de;var ye={uriToZipEntryName:function(e,t){return"/"===t.charAt(0)?t.substr(1):e+"/"+t},replaceFragment:function(e,t){var n=e.indexOf("#");return-1!==n&&(e=e.substring(0,n)),e+"#"+t}};se.createBodyReader=function(e){return{readXmlElement:function(t){return new Oe(e).readXmlElement(t)},readXmlElements:function(t){return new Oe(e).readXmlElements(t)}}},se._readNumberingProperties=Ie;var ge=o,ve=t,we=v,be=O.Result,xe=O.warning,Ee=M,Te=ce,ke=ye;function Oe(e){var t=[],n=[],r=[],a=e.relationships,i=e.contentTypes,u=e.docxFile,o=e.files,l=e.numbering,s=e.styles;function c(e){return Me(e.map(f))}function f(e){if("element"===e.type){var t=w[e.name];if(t)return t(e);if(!Object.prototype.hasOwnProperty.call(Ne,e.name))return Re([xe("An unrecognised element was ignored: "+e.name)])}return Be()}function p(e){return{start:e.attributes["w:start"]||e.attributes["w:left"],end:e.attributes["w:end"]||e.attributes["w:right"],firstLine:e.attributes["w:firstLine"],hanging:e.attributes["w:hanging"]}}function m(e){if(e){var t=e.attributes["w:val"];return void 0!==t&&"false"!==t&&"0"!==t&&"none"!==t}return!1}function d(e){if(e){var t=e.attributes["w:val"];return"false"!==t&&"0"!==t}return!1}function h(e,t,n,r){var a=[],i=e.first(t),u=null,o=null;if(i&&(u=i.attributes["w:val"])){var l=r(u);l?o=l.name:a.push(function(e,t){return xe(e+" style with ID "+t+" was referenced but not defined in the document")}(n,u))}return Ce({styleId:u,name:o},a)}function y(e){return function(e,t){var n=/\s*HYPERLINK "(.*)"/.exec(e);if(n)return{type:"hyperlink",options:{href:n[1]}};var r=/\s*HYPERLINK\s+\\l\s+"(.*)"/.exec(e);if(r)return{type:"hyperlink",options:{anchor:r[1]}};if(/\s*FORMCHECKBOX\s*/.exec(e)){var a=t.firstOrEmpty("w:ffData").firstOrEmpty("w:checkBox"),i=a.first("w:checked");return{type:"checkbox",checked:d(null==i?a.first("w:default"):i)}}return{type:"unknown"}}(n.join(""),"begin"===e.type?e.fldChar:Ee.emptyElement)}function g(e){return function(t){var n=t.attributes["w:id"];return Pe(new we.NoteReference({noteType:e,noteId:n}))}}function v(e){return c(e.children)}var w={"w:p":function(e){var t=e.firstOrEmpty("w:pPr");if(t.firstOrEmpty("w:rPr").first("w:del"))return e.children.forEach(function(e){r.push(e)}),Be();var n=e.children;return r.length>0&&(n=r.concat(n),r=[]),_e.map(function(e){return function(e){return h(e,"w:pStyle","Paragraph",s.findParagraphStyleById)}(e).map(function(t){return{type:"paragraphProperties",styleId:t.styleId,styleName:t.name,alignment:e.firstOrEmpty("w:jc").attributes["w:val"],numbering:Ie(t.styleId,e.firstOrEmpty("w:numPr"),l),indent:p(e.firstOrEmpty("w:ind"))}})}(t),c(n),function(e,t){return new we.Paragraph(t,e)}).insertExtra()},"w:r":function(e){return _e.map(function(e){return function(e){return h(e,"w:rStyle","Run",s.findCharacterStyleById)}(e).map(function(t){var n,r=e.firstOrEmpty("w:sz").attributes["w:val"],a=/^[0-9]+$/.test(r)?parseInt(r,10)/2:null;return{type:"runProperties",styleId:t.styleId,styleName:t.name,verticalAlignment:e.firstOrEmpty("w:vertAlign").attributes["w:val"],font:e.firstOrEmpty("w:rFonts").attributes["w:ascii"],fontSize:a,isBold:d(e.first("w:b")),isUnderline:m(e.first("w:u")),isItalic:d(e.first("w:i")),isStrikethrough:d(e.first("w:strike")),isAllCaps:d(e.first("w:caps")),isSmallCaps:d(e.first("w:smallCaps")),highlight:(n=e.firstOrEmpty("w:highlight").attributes["w:val"],n&&"none"!==n?n:null)}})}(e.firstOrEmpty("w:rPr")),c(e.children),function(e,n){var r,a=(r=ve.last(t.filter(function(e){return"hyperlink"===e.type})))?r.options:null;return null!==a&&(n=[new we.Hyperlink(n,a)]),new we.Run(n,e)})},"w:fldChar":function(e){var r=e.attributes["w:fldCharType"];if("begin"===r)t.push({type:"begin",fldChar:e}),n=[];else if("end"===r){var a=t.pop();if("begin"===a.type&&(a=y(a)),"checkbox"===a.type)return Pe(we.checkbox({checked:a.checked}))}else if("separate"===r){var i=y(t.pop());t.push(i)}return Be()},"w:instrText":function(e){return n.push(e.text()),Be()},"w:t":function(e){return Pe(new we.Text(e.text()))},"w:tab":function(e){return Pe(new we.Tab)},"w:noBreakHyphen":function(){return Pe(new we.Text("‑"))},"w:softHyphen":function(e){return Pe(new we.Text("­"))},"w:sym":function(e){var t=e.attributes["w:font"],n=e.attributes["w:char"],r=ge.hex(t,n);return null==r&&/^F0..$/.test(n)&&(r=ge.hex(t,n.substring(2))),null==r?Re([xe("A w:sym element with an unsupported character was ignored: char "+n+" in font "+t)]):Pe(new we.Text(r.string))},"w:hyperlink":function(e){var t=e.attributes["r:id"],n=e.attributes["w:anchor"];return c(e.children).map(function(r){function i(t){var n=e.attributes["w:tgtFrame"]||null;return new we.Hyperlink(r,ve.extend({targetFrame:n},t))}if(t){var u=a.findTargetByRelationshipId(t);return n&&(u=ke.replaceFragment(u,n)),i({href:u})}return n?i({anchor:n}):r})},"w:tbl":function(e){var t=function(e){return function(e){return h(e,"w:tblStyle","Table",s.findTableStyleById)}(e).map(function(e){return{styleId:e.styleId,styleName:e.name}})}(e.firstOrEmpty("w:tblPr"));return c(e.children).flatMap(b).flatMap(function(e){return t.map(function(t){return we.Table(e,t)})})},"w:tr":function(e){var t=e.firstOrEmpty("w:trPr");if(t.first("w:del"))return Be();var n=!!t.first("w:tblHeader");return c(e.children).map(function(e){return we.TableRow(e,{isHeader:n})})},"w:tc":function(e){return c(e.children).map(function(t){var n=e.firstOrEmpty("w:tcPr"),r=n.firstOrEmpty("w:gridSpan").attributes["w:val"],a=r?parseInt(r,10):1,i=we.TableCell(t,{colSpan:a});return i._vMerge=function(e){var t=e.first("w:vMerge");if(t){var n=t.attributes["w:val"];return"continue"===n||!n}return null}(n),i})},"w:footnoteReference":g("footnote"),"w:endnoteReference":g("endnote"),"w:commentReference":function(e){return Pe(we.commentReference({commentId:e.attributes["w:id"]}))},"w:br":function(e){var t=e.attributes["w:type"];return null==t||"textWrapping"===t?Pe(we.lineBreak):"page"===t?Pe(we.pageBreak):"column"===t?Pe(we.columnBreak):Re([xe("Unsupported break type: "+t)])},"w:bookmarkStart":function(e){var t=e.attributes["w:name"];return"_GoBack"===t?Be():Pe(new we.BookmarkStart({name:t}))},"mc:AlternateContent":function(e){return v(e.firstOrEmpty("mc:Fallback"))},"w:sdt":function(e){return c(e.firstOrEmpty("w:sdtContent").children).map(function(t){var n,r=e.firstOrEmpty("w:sdtPr").first("wordml:checkbox");if(r){var a=r.first("wordml:checked"),i=!!a&&"false"!==(n=a.attributes["wordml:val"])&&"0"!==n,u=we.checkbox({checked:i}),o=!1,l=t.map(Te._elementsOfType(we.types.text,function(e){return e.value.length>0&&!o?(o=!0,u):e}));return o?l:u}return t})},"w:ins":v,"w:object":v,"w:smartTag":v,"w:drawing":v,"w:pict":function(e){return v(e).toExtra()},"v:roundrect":v,"v:shape":v,"v:textbox":v,"w:txbxContent":v,"wp:inline":E,"wp:anchor":E,"v:imagedata":function(e){var t=e.attributes["r:id"];return t?O(k(t),e.attributes["o:title"]):Re([xe("A v:imagedata element without a relationship ID was ignored")])},"v:group":v,"v:rect":v};return{readXmlElement:f,readXmlElements:c};function b(e){if(ve.any(e,function(e){return e.type!==we.types.tableRow}))return x(e),Ce(e,[xe("unexpected non-row element in table, cell merging may be incorrect")]);if(ve.any(e,function(e){return ve.any(e.children,function(e){return e.type!==we.types.tableCell})}))return x(e),Ce(e,[xe("unexpected non-cell element in table row, cell merging may be incorrect")]);var t={};return e.forEach(function(e){var n=0;e.children.forEach(function(e){e._vMerge&&t[n]?t[n].rowSpan++:(t[n]=e,e._vMerge=!1),n+=e.colSpan})}),e.forEach(function(e){e.children=e.children.filter(function(e){return!e._vMerge}),e.children.forEach(function(e){delete e._vMerge})}),Pe(e)}function x(e){e.forEach(function(e){Te.getDescendantsOfType(e,we.types.tableCell).forEach(function(e){delete e._vMerge})})}function E(e){return Me(e.getElementsByTagName("a:graphic").getElementsByTagName("a:graphicData").getElementsByTagName("pic:pic").getElementsByTagName("pic:blipFill").getElementsByTagName("a:blip").map(T.bind(null,e)))}function T(e,t){var n,r=e.first("wp:docPr").attributes,i=null==(n=r.descr)||/^\s*$/.test(n)?r.title:r.descr,u=function(e){var t=e.attributes["r:embed"],n=e.attributes["r:link"];if(t)return k(t);if(n){var r=a.findTargetByRelationshipId(n);return{path:r,read:o.read.bind(o,r)}}return null}(t);return null===u?Re([xe("Could not find image file for a:blip element")]):O(u,i)}function k(e){var t=ke.uriToZipEntryName("word",a.findTargetByRelationshipId(e));return{path:t,read:u.read.bind(u,t)}}function O(e,t){var n=i.findContentType(e.path);return Ce(we.Image({readImage:e.read,altText:t,contentType:n}),Se[n]?[]:xe("Image of type "+n+" is unlikely to display in web browsers"))}}function Ie(e,t,n){var r=t.firstOrEmpty("w:ilvl").attributes["w:val"],a=t.firstOrEmpty("w:numId").attributes["w:val"];if(void 0!==r&&void 0!==a)return n.findLevel(a,r);if(null!=e){var i=n.findLevelByParagraphStyleId(e);if(null!=i)return i}return void 0!==a?n.findLevel(a,"0"):null}var Se={"image/png":!0,"image/gif":!0,"image/jpeg":!0,"image/svg+xml":!0,"image/tiff":!0},Ne={"office-word:wrap":!0,"v:shadow":!0,"v:shapetype":!0,"w:annotationRef":!0,"w:bookmarkEnd":!0,"w:sectPr":!0,"w:proofErr":!0,"w:lastRenderedPageBreak":!0,"w:commentRangeStart":!0,"w:commentRangeEnd":!0,"w:del":!0,"w:footnoteRef":!0,"w:endnoteRef":!0,"w:pPr":!0,"w:rPr":!0,"w:tblPr":!0,"w:tblGrid":!0,"w:trPr":!0,"w:tcPr":!0};function Re(e){return new _e(null,null,e)}function Be(){return new _e(null)}function Pe(e){return new _e(e)}function Ce(e,t){return new _e(e,null,t)}function _e(e,t,n){this.value=e||[],this.extra=t||[],this._result=new be({element:this.value,extra:t},n),this.messages=this._result.messages}function Me(e){var t=be.combine(ve.pluck(e,"_result"));return new _e(ve.flatten(ve.pluck(t.value,"element")),ve.filter(ve.flatten(ve.pluck(t.value,"extra")),qe),t.messages)}function Fe(e,t){return ve.flatten([e,t])}function qe(e){return e}_e.prototype.toExtra=function(){return new _e(null,Fe(this.extra,this.value),this.messages)},_e.prototype.insertExtra=function(){var e=this.extra;return e&&e.length?new _e(Fe(this.value,e),null,this.messages):this},_e.prototype.map=function(e){var t=this._result.map(function(t){return e(t.element)});return new _e(t.value,this.extra,t.messages)},_e.prototype.flatMap=function(e){var t=this._result.flatMap(function(t){return e(t.element)._result});return new _e(t.value.element,Fe(this.extra,t.value.extra),t.messages)},_e.map=function(e,t,n){return new _e(n(e.value,t.value),Fe(e.extra,t.extra),e.messages.concat(t.messages))};var Ae=function(e){var t=e.bodyReader;return{convertXmlToDocument:function(n){var r=n.first("w:body");if(null==r)throw new Error("Could not find the body element: are you sure this is a docx file?");var a=t.readXmlElements(r.children).map(function(t){return new He.Document(t,{notes:e.notes,comments:e.comments})});return new je(a.value,a.messages)}}},He=v,je=O.Result,De={};function We(e){var t={};e.forEach(function(e){t[e.relationshipId]=e.target});var n={};return e.forEach(function(e){n[e.type]||(n[e.type]=[]),n[e.type].push(e.target)}),{findTargetByRelationshipId:function(e){return t[e]},findTargetsByType:function(e){return n[e]||[]}}}De.readRelationships=function(e){var t=[];return e.children.forEach(function(e){if("relationships:Relationship"===e.name){var n={relationshipId:e.attributes.Id,target:e.attributes.Target,type:e.attributes.Type};t.push(n)}}),new We(t)},De.defaultValue=new We([]),De.Relationships=We;var Le={readContentTypesFromXml:function(e){var t={},n={};return e.children.forEach(function(e){if("content-types:Default"===e.name&&(t[e.attributes.Extension]=e.attributes.ContentType),"content-types:Override"===e.name){var r=e.attributes.PartName;"/"===r.charAt(0)&&(r=r.substring(1)),n[r]=e.attributes.ContentType}}),Ue(n,t)}},Xe={png:"png",gif:"gif",jpeg:"jpeg",jpg:"jpeg",tif:"tiff",tiff:"tiff",bmp:"bmp"};function Ue(e,t){return{findContentType:function(n){var r=e[n];if(r)return r;var a=n.split("."),i=a[a.length-1];if(t.hasOwnProperty(i))return t[i];var u=Xe[i.toLowerCase()];return u?"image/"+u:null}}}Le.defaultContentTypes=Ue({},{});var Ve={},ze=t;function Ze(e,t,n){var r=ze.flatten(ze.values(t).map(function(e){return ze.values(e.levels)})),a=ze.indexBy(r.filter(function(e){return null!=e.paragraphStyleId}),"paragraphStyleId");return{findLevel:function r(a,i){var u=e[a];if(u){var o=t[u.abstractNumId];return o?null==o.numStyleLink?t[u.abstractNumId].levels[i]:r(n.findNumberingStyleById(o.numStyleLink).numId,i):null}return null},findLevelByParagraphStyleId:function(e){return a[e]||null}}}Ve.readNumberingXml=function(e,t){if(!t||!t.styles)throw new Error("styles is missing");var n=function(e){var t={};return e.getElementsByTagName("w:abstractNum").forEach(function(e){var n=e.attributes["w:abstractNumId"];t[n]=function(e){var t={},n=null;e.getElementsByTagName("w:lvl").forEach(function(e){var r=e.attributes["w:ilvl"],a="bullet"!==e.firstOrEmpty("w:numFmt").attributes["w:val"],i=e.firstOrEmpty("w:pStyle").attributes["w:val"];void 0===r?n={isOrdered:a,level:"0",paragraphStyleId:i}:t[r]={isOrdered:a,level:r,paragraphStyleId:i}}),null!==n&&void 0===t[n.level]&&(t[n.level]=n);var r=e.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:t,numStyleLink:r}}(e)}),t}(e);return new Ze(function(e){var t={};return e.getElementsByTagName("w:num").forEach(function(e){var n=e.attributes["w:numId"],r=e.first("w:abstractNumId").attributes["w:val"];t[n]={abstractNumId:r}}),t}(e),n,t.styles)},Ve.Numbering=Ze,Ve.defaultNumbering=new Ze({},{});var Ke={};function $e(e,t,n,r){return{findParagraphStyleById:function(t){return e[t]},findCharacterStyleById:function(e){return t[e]},findTableStyleById:function(e){return n[e]},findNumberingStyleById:function(e){return r[e]}}}function Ye(e){return e.attributes["w:styleId"]}Ke.readStylesXml=function(e){var t={},n={},r={},a={},i={paragraph:t,character:n,table:r,numbering:a};return e.getElementsByTagName("w:style").forEach(function(e){var t=function(e){var t=e.attributes["w:type"];if("numbering"===t)return function(e,t){var n=Ye(t);return{type:e,numId:t.firstOrEmpty("w:pPr").firstOrEmpty("w:numPr").firstOrEmpty("w:numId").attributes["w:val"],styleId:n}}(t,e);var n=Ye(e),r=function(e){var t=e.first("w:name");return t?t.attributes["w:val"]:null}(e);return{type:t,styleId:n,name:r}}(e),n=i[t.type];n&&void 0===n[t.styleId]&&(n[t.styleId]=t)}),new $e(t,n,r,a)},Ke.Styles=$e,Ke.defaultStyles=new $e({},{}),$e.EMPTY=new $e({},{},{},{});var Ge={},Je=v,Qe=O.Result;function et(e,t){function n(e){var t=e.attributes["w:type"];return"continuationSeparator"!==t&&"separator"!==t}function r(n){var r=n.attributes["w:id"];return t.readXmlElements(n.children).map(function(t){return Je.Note({noteType:e,noteId:r,body:t})})}return function(t){return Qe.combine(t.getElementsByTagName("w:"+e).filter(n).map(r))}}Ge.createFootnotesReader=et.bind(c,"footnote"),Ge.createEndnotesReader=et.bind(c,"endnote");var tt={},nt=v,rt=O.Result;tt.createCommentsReader=function(e){function t(t){var n=t.attributes["w:id"];function r(e){return(t.attributes[e]||"").trim()||null}return e.readXmlElements(t.children).map(function(e){return nt.comment({commentId:n,body:e,authorName:r("w:author"),authorInitials:r("w:initials")})})}return function(e){return rt.combine(e.getElementsByTagName("w:comment").map(t))}};var at={},it=h;at.Files=function(){return{read:function(e){return it.reject(new Error("could not open external image: '"+e+"'\ncannot open linked files from a web browser"))}}},d.read=function(e,t,n){t=t||{};var r=new wt({externalFileAccess:(n=n||{}).externalFileAccess,relativeToFile:t.path});return ut.props({contentTypes:Ot(e),partPaths:bt(e),docxFile:e,files:r}).also(function(t){return{styles:(n=e,r=t.partPaths.styles,Et({filename:r,readElement:yt.readStylesXml,defaultValue:yt.defaultStyles})(n))};var n,r}).also(function(t){return{numbering:(n=e,r=t.partPaths.numbering,a=t.styles,Et({filename:r,readElement:function(e){return ht.readNumberingXml(e,{styles:a})},defaultValue:ht.defaultNumbering})(n))};var n,r,a}).also(function(e){return{footnotes:Tt(e.partPaths.footnotes,e,function(e,t){return t?gt.createFootnotesReader(e)(t):new lt([])}),endnotes:Tt(e.partPaths.endnotes,e,function(e,t){return t?gt.createEndnotesReader(e)(t):new lt([])}),comments:Tt(e.partPaths.comments,e,function(e,t){return t?vt.createCommentsReader(e)(t):new lt([])})}}).also(function(e){return{notes:e.footnotes.flatMap(function(t){return e.endnotes.map(function(e){return new ot.Notes(t.concat(e))})})}}).then(function(e){return Tt(e.partPaths.mainDocument,e,function(t,n){return e.notes.flatMap(function(r){return e.comments.flatMap(function(e){return new pt({bodyReader:t,notes:r,comments:e}).convertXmlToDocument(n)})})})})},d._findPartPaths=bt;var ut=h,ot=v,lt=O.Result,st=B,ct=_.readXmlFromZipFile,ft=se.createBodyReader,pt=Ae,mt=De,dt=Le,ht=Ve,yt=Ke,gt=Ge,vt=tt,wt=at.Files;function bt(e){return It(e).then(function(t){var n=xt({docxFile:e,relationships:t,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",basePath:"",fallbackPath:"word/document.xml"});if(!e.exists(n))throw new Error("Could not find main document part. Are you sure this is a valid .docx file?");return Et({filename:kt(n),readElement:mt.readRelationships,defaultValue:mt.defaultValue})(e).then(function(t){function r(r){return xt({docxFile:e,relationships:t,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/"+r,basePath:st.splitPath(n).dirname,fallbackPath:"word/"+r+".xml"})}return{mainDocument:n,comments:r("comments"),endnotes:r("endnotes"),footnotes:r("footnotes"),numbering:r("numbering"),styles:r("styles")}})})}function xt(e){var t=e.docxFile,n=e.relationships,r=e.relationshipType,a=e.basePath,i=e.fallbackPath,u=n.findTargetsByType(r).map(function(e){return"/"===(t=st.joinPath(a,e)).substring(0,1)?t.substring(1):t;var t}).filter(function(e){return t.exists(e)});return 0===u.length?i:u[0]}function Et(e){return function(t){return ct(t,e.filename).then(function(t){return t?e.readElement(t):e.defaultValue})}}function Tt(e,t,n){return Et({filename:kt(e),readElement:mt.readRelationships,defaultValue:mt.defaultValue})(t.docxFile).then(function(r){var a=new ft({relationships:r,contentTypes:t.contentTypes,docxFile:t.docxFile,numbering:t.numbering,styles:t.styles,files:t.files});return ct(t.docxFile,e).then(function(e){return n(a,e)})})}function kt(e){var t=st.splitPath(e);return st.joinPath(t.dirname,"_rels",t.basename+".rels")}var Ot=Et({filename:"[Content_Types].xml",readElement:dt.readContentTypesFromXml,defaultValue:dt.defaultContentTypes}),It=Et({filename:"_rels/.rels",readElement:mt.readRelationships,defaultValue:mt.defaultValue}),St={},Nt=t,Rt=h,Bt=M;St.writeStyleMap=function(e,t){return e.write(Ct,t),function(e){var t="word/_rels/document.xml.rels",n="http://schemas.openxmlformats.org/package/2006/relationships",r="{"+n+"}Relationship";return e.read(t,"utf8").then(Bt.readString).then(function(a){Mt(a.children,r,"Id",{Id:"rMammothStyleMap",Type:Pt,Target:_t});var i={"":n};return e.write(t,Bt.writeString(a,i))})}(e).then(function(){return function(e){var t="[Content_Types].xml",n="http://schemas.openxmlformats.org/package/2006/content-types",r="{"+n+"}Override";return e.read(t,"utf8").then(Bt.readString).then(function(a){Mt(a.children,r,"PartName",{PartName:_t,ContentType:"text/prs.mammoth.style-map"});var i={"":n};return e.write(t,Bt.writeString(a,i))})}(e)})},St.readStyleMap=function(e){return e.exists(Ct)?e.read(Ct,"utf8"):Rt.resolve(null)};var Pt="http://schemas.zwobble.org/mammoth/style-map",Ct="mammoth/style-map",_t="/"+Ct;function Mt(e,t,n,r){var a=Nt.find(e,function(e){return e.name===t&&e.attributes[n]===r[n]});a?a.attributes=r:e.push(Bt.element(t,r))}var Ft,qt,At,Ht,jt,Dt={},Wt={},Lt={},Xt={};function Ut(){if(Ft)return Xt;Ft=1;var e=Zt();function t(e,t){return{type:"element",tag:e,children:t||[]}}Xt.freshElement=function(n,r,a){return t(e.element(n,r,{fresh:!0}),a)},Xt.nonFreshElement=function(n,r,a){return t(e.element(n,r,{fresh:!1}),a)},Xt.elementWithTag=t,Xt.text=function(e){return{type:"text",value:e}},Xt.forceWrite={type:"forceWrite"};var n={br:!0,hr:!0,img:!0,input:!0};return Xt.isVoidElement=function(e){return 0===e.children.length&&n[e.tag.tagName]},Xt}function Vt(){if(At)return qt;At=1;var e=t,n=Ut();function r(e){var t=[];return e.map(a).forEach(function(e){o(t,e)}),t}function a(e){return i[e.type](e)}var i={element:function(e){return n.elementWithTag(e.tag,r(e.children))},text:u,forceWrite:u};function u(e){return e}function o(e,t){var r=e[e.length-1];"element"===t.type&&!t.tag.fresh&&r&&"element"===r.type&&t.tag.matchesElement(r.tag)?(t.tag.separator&&o(r.children,n.text(t.tag.separator)),t.children.forEach(function(e){o(r.children,e)})):e.push(t)}function l(t){return n=t,r=function(e){return s[e.type](e)},e.flatten(e.map(n,r),!0);var n,r}var s={element:function(e){var t=l(e.children);return 0!==t.length||n.isVoidElement(e)?[n.elementWithTag(e.tag,t)]:[]},text:function(e){return 0===e.value.length?[]:[e]},forceWrite:function(e){return[e]}};return qt=function(e){return r(l(e))}}function zt(){if(Ht)return Lt;Ht=1;var e=Ut();function t(e,t){t.forEach(function(t){!function(e,t){n[t.type](e,t)}(e,t)})}Lt.freshElement=e.freshElement,Lt.nonFreshElement=e.nonFreshElement,Lt.elementWithTag=e.elementWithTag,Lt.text=e.text,Lt.forceWrite=e.forceWrite,Lt.simplify=Vt();var n={element:function(n,r){e.isVoidElement(r)?n.selfClosing(r.tag.tagName,r.tag.attributes):(n.open(r.tag.tagName,r.tag.attributes),t(n,r.children),n.close(r.tag.tagName))},text:function(e,t){e.text(t.value)},forceWrite:function(){}};return Lt.write=t,Lt}function Zt(){if(jt)return Wt;jt=1;var e=t,n=zt();function r(t){return new a(t.map(function(t){return e.isString(t)?i(t):t}))}function a(e){this._elements=e}function i(e,t,n){return new u(e,t,n=n||{})}function u(t,n,r){var a={};e.isArray(t)?(t.forEach(function(e){a[e]=!0}),t=t[0]):a[t]=!0,this.tagName=t,this.tagNames=a,this.attributes=n||{},this.fresh=r.fresh,this.separator=r.separator}return Wt.topLevelElement=function(e,t){return r([i(e,t,{fresh:!0})])},Wt.elements=r,Wt.element=i,a.prototype.wrap=function(e){for(var t=e(),n=this._elements.length-1;n>=0;n--)t=this._elements[n].wrapNodes(t);return t},u.prototype.matchesElement=function(t){return this.tagNames[t.tagName]&&e.isEqual(this.attributes||{},t.attributes||{})},u.prototype.wrap=function(e){return this.wrapNodes(e())},u.prototype.wrapNodes=function(e){return[n.elementWithTag(this,e)]},Wt.empty=r([]),Wt.ignore={wrap:function(){return[]}},Wt}var Kt={};!function(e){var n=t,r=h,a=zt();function i(e){return function(t,i){return r.when(e(t)).then(function(e){var r={};return t.altText&&(r.alt=t.altText),n.extend(r,e),[a.freshElement("img",r)]})}}e.imgElement=i,e.inline=e.imgElement,e.dataUri=i(function(e){return e.readAsBase64String().then(function(t){return{src:"data:"+e.contentType+";base64,"+t}})})}(Kt);var $t={},Yt={},Gt=t;Yt.writer=function(e){return(e=e||{}).prettyPrint?function(){var e=0,t=[],n=!0,r=!1,a=Qt();function i(){if(r=!1,!n&&(0===t.length||Jt[t[t.length-1]])&&!u()){a._append("\n");for(var i=0;i<e;i++)a._append("  ")}}function u(){return Gt.some(t,function(e){return"pre"===e})}return{asString:a.asString,open:function(r,u){Jt[r]&&i(),t.push(r),a.open(r,u),Jt[r]&&e++,n=!1},close:function(n){Jt[n]&&(e--,i()),t.pop(),a.close(n)},text:function(e){r||(i(),r=!0);var t=u()?e:e.replace("\n","\n  ");a.text(t)},selfClosing:function(e,t){i(),a.selfClosing(e,t)}}}():Qt()};var Jt={div:!0,p:!0,ul:!0,li:!0};function Qt(){var e=[];function t(e){return Gt.map(e,function(e,t){return" "+t+'="'+function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}(e)+'"'}).join("")}return{asString:function(){return e.join("")},open:function(n,r){var a=t(r);e.push("<"+n+a+">")},close:function(t){e.push("</"+t+">")},text:function(t){e.push(function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}(t))},selfClosing:function(n,r){var a=t(r);e.push("<"+n+a+" />")},_append:function(t){e.push(t)}}}var en={},tn=t;function nn(e){return rn(e,e)}function rn(e,t){return function(){return{start:e,end:t}}}function an(e){return function(t,n){return{start:n?"\n":"",end:n?"":"\n",list:{isOrdered:e.isOrdered,indent:n?n.indent+1:0,count:0}}}}var un={p:rn("","\n\n"),br:rn("","  \n"),ul:an({isOrdered:!1}),ol:an({isOrdered:!0}),li:function(e,t,n){(t=t||{indent:0,isOrdered:!1,count:0}).count++,n.hasClosed=!1;var r=t.isOrdered?t.count+".":"-";return{start:on("\t",t.indent)+r+" ",end:function(){if(!n.hasClosed)return n.hasClosed=!0,"\n"}}},strong:nn("__"),em:nn("*"),a:function(e){var t=e.href||"";return t?{start:"[",end:"]("+t+")",anchorPosition:"before"}:{}},img:function(e){var t=e.src||"",n=e.alt||"";return t||n?{start:"!["+n+"]("+t+")"}:{}}};function on(e,t){return new Array(t+1).join(e)}!function(){for(var e=1;e<=6;e++)un["h"+e]=rn(on("#",e)+" ","\n\n")}(),en.writer=function(){var e=[],t=[],n=null,r={};function a(a,u){u=u||{};var o=(un[a]||function(){return{}})(u,n,r);t.push({end:o.end,list:n}),o.list&&(n=o.list);var l="before"===o.anchorPosition;l&&i(u),e.push(o.start||""),l||i(u)}function i(t){t.id&&e.push('<a id="'+t.id+'"></a>')}function u(r){var a=t.pop();n=a.list;var i=tn.isFunction(a.end)?a.end():a.end;e.push(i||"")}return{asString:function(){return e.join("")},open:a,close:u,text:function(t){e.push(function(e){return e.replace(/\\/g,"\\\\").replace(/([\`\*_\{\}\[\]\(\)\#\+\-\.\!])/g,"\\$1")}(t))},selfClosing:function(e,t){a(e,t),u()}}};var ln=Yt,sn=en;$t.writer=function(e){return"markdown"===(e=e||{}).outputFormat?sn.writer():ln.writer(e)};var cn=t,fn=h,pn=v,mn=Zt(),dn=O,hn=Kt,yn=zt(),gn=$t;function vn(e,t){var n=1,r=[],a=[],i=void 0===(e=cn.extend({ignoreEmptyParagraphs:!0},e)).idPrefix?"":e.idPrefix,u=e.ignoreEmptyParagraphs,o=mn.topLevelElement("p"),l=e.styleMap||[];function s(e,t,n){return xn(e,function(e){return c(e,t,n)})}function c(e,t,n){if(!n)throw new Error("options not set");var r=T[e.type];return r?r(e,t,n):[]}function f(e,t){return p({type:e})||(t?mn.element(t,{},{fresh:!1}):mn.empty)}function p(e,t){var n=m(e);return n?n.to:t}function m(e){for(var t=0;t<l.length;t++)if(l[t].from.matches(e))return l[t]}function d(e){return y(e.noteType,e.noteId)}function h(e){return g(e.noteType,e.noteId)}function y(e,t){return v(e+"-"+t)}function g(e,t){return v(e+"-ref-"+t)}function v(e){return i+e}var w=mn.elements([mn.element("table",{},{fresh:!0})]);function b(e,t,n){var r=e.label,a=e.comment,i=s(a.body,t,n).concat([yn.nonFreshElement("p",{},[yn.text(" "),yn.freshElement("a",{href:"#"+g("comment",a.commentId)},[yn.text("↑")])])]);return[yn.freshElement("dt",{id:y("comment",a.commentId)},[yn.text("Comment "+r)]),yn.freshElement("dd",{},i)]}var x,E,T={document:function(e,t,n){var i=s(e.children,t,n),u=s(r.map(function(t){return e.notes.resolve(t)}),t,n);return i.concat([yn.freshElement("ol",{},u),yn.freshElement("dl",{},xn(a,function(e){return b(e,t,n)}))])},paragraph:function(e,t,n){return function(e,t){var n=m(e);return n?n.to:(e.styleId&&t.push(bn("paragraph",e)),o)}(e,t).wrap(function(){var r=s(e.children,t,n);return u?r:[yn.forceWrite].concat(r)})},run:function(e,t,n){var r=function(){return s(e.children,t,n)},a=[];if(null!==e.highlight){var i=p({type:"highlight",color:e.highlight});i&&a.push(i)}e.isSmallCaps&&a.push(f("smallCaps")),e.isAllCaps&&a.push(f("allCaps")),e.isStrikethrough&&a.push(f("strikethrough","s")),e.isUnderline&&a.push(f("underline")),e.verticalAlignment===pn.verticalAlignment.subscript&&a.push(mn.element("sub",{},{fresh:!1})),e.verticalAlignment===pn.verticalAlignment.superscript&&a.push(mn.element("sup",{},{fresh:!1})),e.isItalic&&a.push(f("italic","em")),e.isBold&&a.push(f("bold","strong"));var u=mn.empty,o=m(e);return o?u=o.to:e.styleId&&t.push(bn("run",e)),a.push(u),a.forEach(function(e){r=e.wrap.bind(e,r)}),r()},text:function(e,t,n){return[yn.text(e.value)]},tab:function(e,t,n){return[yn.text("\t")]},hyperlink:function(e,t,n){var r={href:e.anchor?"#"+v(e.anchor):e.href};null!=e.targetFrame&&(r.target=e.targetFrame);var a=s(e.children,t,n);return[yn.nonFreshElement("a",r,a)]},checkbox:function(e){var t={type:"checkbox"};return e.checked&&(t.checked="checked"),[yn.freshElement("input",t)]},bookmarkStart:function(e,t,n){return[yn.freshElement("a",{id:v(e.name)},[yn.forceWrite])]},noteReference:function(e,t,a){r.push(e);var i=yn.freshElement("a",{href:"#"+d(e),id:h(e)},[yn.text("["+n+++"]")]);return[yn.freshElement("sup",{},[i])]},note:function(e,t,n){var r=s(e.body,t,n),a=yn.elementWithTag(mn.element("p",{},{fresh:!1}),[yn.text(" "),yn.freshElement("a",{href:"#"+h(e)},[yn.text("↑")])]),i=r.concat([a]);return yn.freshElement("li",{id:d(e)},i)},commentReference:function(e,n,r){return p(e,mn.ignore).wrap(function(){var n=t[e.commentId],r=a.length+1,i="["+Tn(n)+r+"]";return a.push({label:i,comment:n}),[yn.freshElement("a",{href:"#"+y("comment",e.commentId),id:g("comment",e.commentId)},[yn.text(i)])]})},comment:b,image:(E=e.convertImage||hn.dataUri,x=function(e,t){return fn.attempt(function(){return E(e,t)}).caught(function(e){return t.push(dn.error(e)),[]})},function(e,t,n){return[{type:"deferred",id:wn++,value:function(){return x(e,t)}}]}),table:function(e,t,n){return p(e,w).wrap(function(){return function(e,t,n){var r,a=cn.findIndex(e.children,function(e){return!e.type===pn.types.tableRow||!e.isHeader});if(-1===a&&(a=e.children.length),0===a)r=s(e.children,t,cn.extend({},n,{isTableHeader:!1}));else{var i=s(e.children.slice(0,a),t,cn.extend({},n,{isTableHeader:!0})),u=s(e.children.slice(a),t,cn.extend({},n,{isTableHeader:!1}));r=[yn.freshElement("thead",{},i),yn.freshElement("tbody",{},u)]}return[yn.forceWrite].concat(r)}(e,t,n)})},tableRow:function(e,t,n){var r=s(e.children,t,n);return[yn.freshElement("tr",{},[yn.forceWrite].concat(r))]},tableCell:function(e,t,n){var r=n.isTableHeader?"th":"td",a=s(e.children,t,n),i={};return 1!==e.colSpan&&(i.colspan=e.colSpan.toString()),1!==e.rowSpan&&(i.rowspan=e.rowSpan.toString()),[yn.freshElement(r,i,[yn.forceWrite].concat(a))]},break:function(e,t,n){return function(e){var t=m(e);return t?t.to:"line"===e.breakType?mn.topLevelElement("br"):mn.empty}(e).wrap(function(){return[]})}};return{convertToHtml:function(t){var n=[],r=c(t,n,{}),a=[];En(r,function(e){"deferred"===e.type&&a.push(e)});var i={};return fn.mapSeries(a,function(e){return e.value().then(function(t){i[e.id]=t})}).then(function(){var t=gn.writer({prettyPrint:e.prettyPrint,outputFormat:e.outputFormat});return yn.write(t,yn.simplify(function e(t){return xn(t,function(t){return"deferred"===t.type?i[t.id]:t.children?[cn.extend({},t,{children:e(t.children)})]:[t]})}(r))),new dn.Result(t.asString(),n)})}}}Dt.DocumentConverter=function(e){return{convertToHtml:function(t){var n=cn.indexBy(t.type===pn.types.document?t.comments:[],"commentId");return new vn(e,n).convertToHtml(t)}}};var wn=1;function bn(e,t){return dn.warning("Unrecognised "+e+" style: '"+t.styleName+"' (Style ID: "+t.styleId+")")}function xn(e,t){return cn.flatten(e.map(t),!0)}function En(e,t){e.forEach(function(e){t(e),e.children&&En(e.children,t)})}var Tn=Dt.commentAuthorLabel=function(e){return e.authorInitials||""},kn={},On=v;kn.convertElementToRawText=function e(t){if("text"===t.type)return t.value;if(t.type===On.types.tab)return"\t";var n="paragraph"===t.type?"\n\n":"";return(t.children||[]).map(e).join("")+n};var In={},Sn={};function Nn(e,t){t=t||{},this._elementType=e,this._styleId=t.styleId,this._styleName=t.styleName,t.list&&(this._listIndex=t.list.levelIndex,this._listIsOrdered=t.list.isOrdered)}function Rn(e){e=e||{},this._color=e.color}function Bn(e){e=e||{},this._breakType=e.breakType}function Pn(e,t){return e.toUpperCase()===t.toUpperCase()}function Cn(e,t){return 0===t.toUpperCase().indexOf(e.toUpperCase())}Sn.paragraph=function(e){return new Nn("paragraph",e)},Sn.run=function(e){return new Nn("run",e)},Sn.table=function(e){return new Nn("table",e)},Sn.bold=new Nn("bold"),Sn.italic=new Nn("italic"),Sn.underline=new Nn("underline"),Sn.strikethrough=new Nn("strikethrough"),Sn.allCaps=new Nn("allCaps"),Sn.smallCaps=new Nn("smallCaps"),Sn.highlight=function(e){return new Rn(e)},Sn.commentReference=new Nn("commentReference"),Sn.lineBreak=new Bn({breakType:"line"}),Sn.pageBreak=new Bn({breakType:"page"}),Sn.columnBreak=new Bn({breakType:"column"}),Sn.equalTo=function(e){return{operator:Pn,operand:e}},Sn.startsWith=function(e){return{operator:Cn,operand:e}},Nn.prototype.matches=function(e){return e.type===this._elementType&&(void 0===this._styleId||e.styleId===this._styleId)&&(void 0===this._styleName||e.styleName&&this._styleName.operator(this._styleName.operand,e.styleName))&&(void 0===this._listIndex||function(e,t,n){return e.numbering&&e.numbering.level==t&&e.numbering.isOrdered==n}(e,this._listIndex,this._listIsOrdered))&&(void 0===this._breakType||this._breakType===e.breakType)},Rn.prototype.matches=function(e){return"highlight"===e.type&&(void 0===this._color||e.color===this._color)},Bn.prototype.matches=function(e){return"break"===e.type&&(void 0===this._breakType||e.breakType===this._breakType)};var _n={},Mn=l.RegexTokeniser;_n.tokenise=function(e){var t="(?:[a-zA-Z\\-_]|\\\\.)";return new Mn([{name:"identifier",regex:new RegExp("("+t+"(?:"+t+"|[0-9])*)")},{name:"dot",regex:/\./},{name:"colon",regex:/:/},{name:"gt",regex:/>/},{name:"whitespace",regex:/\s+/},{name:"arrow",regex:/=>/},{name:"equals",regex:/=/},{name:"startsWith",regex:/\^=/},{name:"open-paren",regex:/\(/},{name:"close-paren",regex:/\)/},{name:"open-square-bracket",regex:/\[/},{name:"close-square-bracket",regex:/\]/},{name:"string",regex:new RegExp(Fn+"'")},{name:"unterminated-string",regex:new RegExp(Fn)},{name:"integer",regex:/([0-9]+)/},{name:"choice",regex:/\|/},{name:"bang",regex:/(!)/}]).tokenise(e)};var Fn="'((?:\\\\.|[^'])*)",qn=t,An=l,Hn=Sn,jn=Zt(),Dn=_n.tokenise,Wn=O;function Ln(){var e=An.rules.sequence,t=function(e,t){return An.rules.then(An.rules.token("identifier",e),function(){return t})},n=t("p",Hn.paragraph),r=t("r",Hn.run),a=An.rules.firstOf("p or r or table",n,r),i=An.rules.sequence(An.rules.tokenOfType("dot"),An.rules.sequence.cut(),An.rules.sequence.capture(Un)).map(function(e){return{styleId:e}}),u=An.rules.firstOf("style name matcher",An.rules.then(An.rules.sequence(An.rules.tokenOfType("equals"),An.rules.sequence.cut(),An.rules.sequence.capture(zn)).head(),function(e){return{styleName:Hn.equalTo(e)}}),An.rules.then(An.rules.sequence(An.rules.tokenOfType("startsWith"),An.rules.sequence.cut(),An.rules.sequence.capture(zn)).head(),function(e){return{styleName:Hn.startsWith(e)}})),o=An.rules.sequence(An.rules.tokenOfType("open-square-bracket"),An.rules.sequence.cut(),An.rules.token("identifier","style-name"),An.rules.sequence.capture(u),An.rules.tokenOfType("close-square-bracket")).head(),l=An.rules.firstOf("list type",t("ordered-list",{isOrdered:!0}),t("unordered-list",{isOrdered:!1})),s=e(An.rules.tokenOfType("colon"),e.capture(l),e.cut(),An.rules.tokenOfType("open-paren"),e.capture(Vn),An.rules.tokenOfType("close-paren")).map(function(e,t){return{list:{isOrdered:e.isOrdered,levelIndex:t-1}}});function c(e){var t=An.rules.firstOf.apply(An.rules.firstOf,["matcher suffix"].concat(e)),n=An.rules.zeroOrMore(t);return An.rules.then(n,function(e){var t={};return e.forEach(function(e){qn.extend(t,e)}),t})}var f=e(e.capture(a),e.capture(c([i,o,s]))).map(function(e,t){return e(t)}),p=e(An.rules.token("identifier","table"),e.capture(c([i,o]))).map(function(e){return Hn.table(e)}),m=t("b",Hn.bold),d=t("i",Hn.italic),h=t("u",Hn.underline),y=t("strike",Hn.strikethrough),g=t("all-caps",Hn.allCaps),v=t("small-caps",Hn.smallCaps),w=e(An.rules.token("identifier","highlight"),An.rules.sequence.capture(An.rules.optional(An.rules.sequence(An.rules.tokenOfType("open-square-bracket"),An.rules.sequence.cut(),An.rules.token("identifier","color"),An.rules.tokenOfType("equals"),An.rules.sequence.capture(zn),An.rules.tokenOfType("close-square-bracket")).head()))).map(function(e){return Hn.highlight({color:e.valueOrElse(void 0)})}),b=t("comment-reference",Hn.commentReference),x=e(An.rules.token("identifier","br"),e.cut(),An.rules.tokenOfType("open-square-bracket"),An.rules.token("identifier","type"),An.rules.tokenOfType("equals"),e.capture(zn),An.rules.tokenOfType("close-square-bracket")).map(function(e){switch(e){case"line":return Hn.lineBreak;case"page":return Hn.pageBreak;case"column":return Hn.columnBreak}});return An.rules.firstOf("element type",f,p,m,d,h,y,g,v,w,b,x)}function Xn(){var e=An.rules.sequence.capture,t=An.rules.tokenOfType("whitespace"),n=An.rules.then(An.rules.optional(An.rules.sequence(An.rules.tokenOfType("colon"),An.rules.token("identifier","fresh"))),function(e){return e.map(function(){return!0}).valueOrElse(!1)}),r=An.rules.then(An.rules.optional(An.rules.sequence(An.rules.tokenOfType("colon"),An.rules.token("identifier","separator"),An.rules.tokenOfType("open-paren"),e(zn),An.rules.tokenOfType("close-paren")).head()),function(e){return e.valueOrElse("")}),a=An.rules.oneOrMoreWithSeparator(Un,An.rules.tokenOfType("choice")),i=An.rules.sequence(e(a),e(An.rules.zeroOrMore(Gn)),e(n),e(r)).map(function(e,t,n,r){var a={},i={};return t.forEach(function(e){e.append&&a[e.name]?a[e.name]+=" "+e.value:a[e.name]=e.value}),n&&(i.fresh=!0),r&&(i.separator=r),jn.element(e,a,i)});return An.rules.firstOf("html path",An.rules.then(An.rules.tokenOfType("bang"),function(){return jn.ignore}),An.rules.then(An.rules.zeroOrMoreWithSeparator(i,An.rules.sequence(t,An.rules.tokenOfType("gt"),t)),jn.elements))}In.readHtmlPath=function(e){return Jn(Xn(),e)},In.readDocumentMatcher=function(e){return Jn(Ln(),e)},In.readStyle=function(e){return Jn(tr,e)};var Un=An.rules.then(An.rules.tokenOfType("identifier"),Kn),Vn=An.rules.tokenOfType("integer"),zn=An.rules.then(An.rules.tokenOfType("string"),Kn),Zn={n:"\n",r:"\r",t:"\t"};function Kn(e){return e.replace(/\\(.)/g,function(e,t){return Zn[t]||t})}var $n=An.rules.sequence(An.rules.tokenOfType("open-square-bracket"),An.rules.sequence.cut(),An.rules.sequence.capture(Un),An.rules.tokenOfType("equals"),An.rules.sequence.capture(zn),An.rules.tokenOfType("close-square-bracket")).map(function(e,t){return{name:e,value:t,append:!1}}),Yn=An.rules.sequence(An.rules.tokenOfType("dot"),An.rules.sequence.cut(),An.rules.sequence.capture(Un)).map(function(e){return{name:"class",value:e,append:!0}}),Gn=An.rules.firstOf("attribute or class",$n,Yn);function Jn(e,t){var n=Dn(t),r=An.Parser().parseTokens(e,n);return r.isSuccess()?Wn.success(r.value()):new Wn.Result(null,[Wn.warning(Qn(t,r))])}function Qn(e,t){return"Did not understand this style mapping, so ignored it: "+e+"\n"+t.errors().map(er).join("\n")}function er(e){return"Error was at character number "+e.characterNumber()+": Expected "+e.expected+" but got "+e.actual}var tr=An.rules.sequence(An.rules.sequence.capture(Ln()),An.rules.tokenOfType("whitespace"),An.rules.tokenOfType("arrow"),An.rules.sequence.capture(An.rules.optional(An.rules.sequence(An.rules.tokenOfType("whitespace"),An.rules.sequence.capture(Xn())).head())),An.rules.tokenOfType("end")).map(function(e,t){return{from:e,to:t.valueOrElse(jn.empty)}}),nr={readOptions:function(e){return e=e||{},rr.extend({},ir,e,{customStyleMap:ur(e.styleMap),readStyleMap:function(){var e=this.customStyleMap;return this.includeEmbeddedStyleMap&&(e=e.concat(ur(this.embeddedStyleMap))),this.includeDefaultStyleMap&&(e=e.concat(ar)),e}})}},rr=t,ar=nr._defaultStyleMap=["p.Heading1 => h1:fresh","p.Heading2 => h2:fresh","p.Heading3 => h3:fresh","p.Heading4 => h4:fresh","p.Heading5 => h5:fresh","p.Heading6 => h6:fresh","p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Heading 4'] => h4:fresh","p[style-name='Heading 5'] => h5:fresh","p[style-name='Heading 6'] => h6:fresh","p[style-name='heading 1'] => h1:fresh","p[style-name='heading 2'] => h2:fresh","p[style-name='heading 3'] => h3:fresh","p[style-name='heading 4'] => h4:fresh","p[style-name='heading 5'] => h5:fresh","p[style-name='heading 6'] => h6:fresh","p.Heading => h1:fresh","p[style-name='Heading'] => h1:fresh","r[style-name='Strong'] => strong","p[style-name='footnote text'] => p:fresh","r[style-name='footnote reference'] =>","p[style-name='endnote text'] => p:fresh","r[style-name='endnote reference'] =>","p[style-name='annotation text'] => p:fresh","r[style-name='annotation reference'] =>","p[style-name='Footnote'] => p:fresh","r[style-name='Footnote anchor'] =>","p[style-name='Endnote'] => p:fresh","r[style-name='Endnote anchor'] =>","p:unordered-list(1) => ul > li:fresh","p:unordered-list(2) => ul|ol > li > ul > li:fresh","p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:ordered-list(1) => ol > li:fresh","p:ordered-list(2) => ul|ol > li > ol > li:fresh","p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","r[style-name='Hyperlink'] =>","p[style-name='Normal'] => p:fresh","p.Body => p:fresh","p[style-name='Body'] => p:fresh"],ir=nr._standardOptions={externalFileAccess:!1,transformDocument:function(e){return e},includeDefaultStyleMap:!0,includeEmbeddedStyleMap:!0};function ur(e){return e?rr.isString(e)?e.split("\n").map(function(e){return e.trim()}).filter(function(e){return""!==e&&"#"!==e.charAt(0)}):e:[]}var or={},lr=h,sr=B;or.openZip=function(e){return e.arrayBuffer?lr.resolve(sr.openArrayBuffer(e.arrayBuffer)):lr.reject(new Error("Could not find file in options"))};var cr={},fr=Zt(),pr=zt();cr.element=function(e){return function(t){return pr.elementWithTag(fr.element(e),[t])}};var mr=t,dr=d,hr=St,yr=Dt.DocumentConverter,gr=kn.convertElementToRawText,vr=In.readStyle,wr=nr.readOptions,br=or,xr=O.Result,Er=m.convertToHtml=function(e,t){return Pr(e,t)},Tr=m.convertToMarkdown=function(e,t){var n=Object.create(t||{});return n.outputFormat="markdown",Pr(e,n)},kr=m.convert=Pr,Or=m.extractRawText=function(e){return br.openZip(e).then(dr.read).then(function(e){return e.map(gr)})},Ir=m.images=Kt,Sr=m.transforms=ce,Nr=m.underline=cr,Rr=m.embedStyleMap=function(e,t){return br.openZip(e).tap(function(e){return hr.writeStyleMap(e,t)}).then(function(e){return e.toArrayBuffer()}).then(function(e){return{toArrayBuffer:function(){return e},toBuffer:function(){return Buffer.from(e)}}})},Br=m.readEmbeddedStyleMap=function(e){return br.openZip(e).then(hr.readStyleMap)};function Pr(e,t){return t=wr(t),br.openZip(e).tap(function(e){return hr.readStyleMap(e).then(function(e){t.embeddedStyleMap=e})}).then(function(n){return dr.read(n,e,t).then(function(e){return e.map(t.transformDocument)}).then(function(e){return function(e,t){var n,r=(n=t.readStyleMap(),xr.combine((n||[]).map(vr)).map(function(e){return e.filter(function(e){return!!e})})),a=mr.extend({},t,{styleMap:r.value}),i=new yr(a);return e.flatMapThen(function(e){return r.flatMapThen(function(t){return i.convertToHtml(e)})})}(e,t)})})}var Cr=m.styleMapping=function(){throw new Error("Use a raw string instead of mammoth.styleMapping e.g. \"p[style-name='Title'] => h1\" instead of mammoth.styleMapping(\"p[style-name='Title'] => h1\")")};const _r=s({__proto__:null,convert:kr,convertToHtml:Er,convertToMarkdown:Tr,default:m,embedStyleMap:Rr,extractRawText:Or,images:Ir,readEmbeddedStyleMap:Br,styleMapping:Cr,transforms:Sr,underline:Nr},[m]);export{p as a,c,f as g,_r as i};
