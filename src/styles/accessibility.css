/**
 * ESTILOS GLOBAIS DE ACESSIBILIDADE
 * Padrões WCAG AA implementados
 * 
 * Baseado em:
 * - WCAG 2.1 Level AA
 * - :focus-visible polyfill
 * - Tamanhos mínimos de toque (WCAG 2.5.5)
 */

/* ====================================
   FOCUS VISIBLE - NAVEGAÇÃO POR TECLADO
   ==================================== */

/**
 * IMPORTANTE: NÃO remover outline globalmente!
 * Isso viola WCAG 2.4.7 (Focus Visible)
 *
 * Navegadores modernos suportam :focus-visible nativamente,
 * que mostra outline apenas para navegação por teclado.
 *
 * Se precisar customizar, use :focus-visible em vez de :focus
 */

/**
 * Focus visible apenas para navegação por teclado
 * Não aparece ao clicar com mouse
 */
*:focus-visible {
  outline: 2px solid hsl(var(--ring));
  outline-offset: 2px;
  border-radius: 4px;
  transition: outline 0.2s ease-in-out;
}

/**
 * Focus visible para botões e links
 */
button:focus-visible,
a:focus-visible,
[role="button"]:focus-visible {
  outline: 2px solid hsl(var(--ring));
  outline-offset: 2px;
  box-shadow: 0 0 0 4px hsl(var(--ring) / 0.2);
}

/**
 * Focus visible para inputs e textareas
 */
input:focus-visible,
textarea:focus-visible,
select:focus-visible {
  outline: 2px solid hsl(var(--ring));
  outline-offset: 2px;
  border-color: hsl(var(--ring));
}

/* ====================================
   CONTRASTE DE CORES - WCAG AA (4.5:1)
   ==================================== */

/**
 * Garante contraste mínimo para textos
 */
.text-muted-foreground {
  /* Aumenta contraste para WCAG AA */
  color: hsl(var(--muted-foreground));
  opacity: 0.85;
}

/**
 * Contraste para links
 */
a {
  color: hsl(var(--primary));
  text-decoration: underline;
  text-decoration-color: hsl(var(--primary) / 0.3);
  transition: text-decoration-color 0.2s;
}

a:hover {
  text-decoration-color: hsl(var(--primary));
}

a:focus-visible {
  text-decoration: none;
}

/**
 * Contraste para badges e tags
 */
.badge,
[role="status"] {
  /* Garante legibilidade de texto em badges */
  font-weight: 500;
}

/* ====================================
   TAMANHOS MÍNIMOS DE TOQUE (44x44px)
   ==================================== */

/**
 * WCAG 2.5.5 - Target Size
 * Tamanho mínimo de 44x44px para touch targets em dispositivos móveis
 * Em desktop (640px+), tamanhos menores são aceitáveis
 */
@media (max-width: 639px) {
  button,
  a,
  [role="button"],
  [role="link"] {
    min-height: 44px;
  }
}

button,
a,
[role="button"],
[role="link"] {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

/**
 * Exceção para botões pequenos explícitos
 * (usar com cuidado e apenas para contextos desktop)
 */
button.btn-sm,
[data-size="sm"] {
  min-height: 36px;
  min-width: 36px;
  padding: 6px 12px;
}

/* ====================================
   NAVEGAÇÃO POR TECLADO
   ==================================== */

/**
 * Skip links para pular para conteúdo principal
 */
.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  background: hsl(var(--primary));
  color: hsl(var(--primary-foreground));
  padding: 8px 16px;
  text-decoration: none;
  z-index: 9999;
  transition: top 0.3s;
}

.skip-link:focus {
  top: 0;
}

/**
 * Indicador de ordem de foco (debugging)
 */
[data-focus-order] {
  position: relative;
}

/* ====================================
   ACESSIBILIDADE PARA SCREEN READERS
   ==================================== */

/**
 * Classe .sr-only para conteúdo apenas para screen readers
 */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/**
 * Conteúdo sr-only que se torna visível ao focar
 */
.sr-only-focusable:focus,
.sr-only-focusable:active {
  position: static;
  width: auto;
  height: auto;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* ====================================
   ANIMAÇÕES E MOVIMENTO
   ==================================== */

/**
 * Respeita preferência do usuário por movimento reduzido
 * WCAG 2.3.3 - Animation from Interactions
 */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ====================================
   CONTRASTE ALTO (TEMA ESCURO)
   ==================================== */

/**
 * Ajustes para modo escuro
 */
.dark {
  /* Aumenta contraste de textos secundários no dark mode */
}

.dark .text-muted-foreground {
  opacity: 0.9;
}

/* ====================================
   ESTADOS DE ERRO E VALIDAÇÃO
   ==================================== */

/**
 * Estados de erro visíveis
 */
[aria-invalid="true"],
.error {
  border-color: hsl(var(--destructive));
  background-color: hsl(var(--destructive) / 0.1);
}

[aria-invalid="true"]:focus-visible {
  outline-color: hsl(var(--destructive));
  box-shadow: 0 0 0 4px hsl(var(--destructive) / 0.2);
}

/**
 * Mensagens de erro
 */
[role="alert"],
.error-message {
  color: hsl(var(--destructive));
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 6px;
  background-color: hsl(var(--destructive) / 0.1);
  border: 1px solid hsl(var(--destructive) / 0.3);
}

/* ====================================
   TOOLTIPS E POPUPS ACESSÍVEIS
   ==================================== */

/**
 * Tooltips devem ser legíveis e contrastantes
 */
[role="tooltip"] {
  background: hsl(var(--popover));
  color: hsl(var(--popover-foreground));
  border: 1px solid hsl(var(--border));
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
  font-size: 0.875rem;
  padding: 6px 12px;
  border-radius: 6px;
  max-width: 250px;
}

/* ====================================
   TABELAS E LISTAS ACESSÍVEIS
   ==================================== */

/**
 * Cabeçalhos de tabela destacados
 */
th {
  font-weight: 600;
  text-align: left;
  background-color: hsl(var(--muted));
  padding: 12px 16px;
}

/**
 * Listas semânticas
 */
ul[role="list"],
ol[role="list"] {
  list-style: none;
  padding: 0;
}

/* ====================================
   CARREGAMENTO E ESTADOS LOADING
   ==================================== */

/**
 * Indicadores de carregamento devem ser anunciados
 */
[aria-live="polite"],
[aria-live="assertive"] {
  position: relative;
}

/**
 * Skeleton loading states
 */
.skeleton {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  background: linear-gradient(
    90deg,
    hsl(var(--muted)) 0%,
    hsl(var(--muted) / 0.5) 50%,
    hsl(var(--muted)) 100%
  );
  background-size: 200% 100%;
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

/* ====================================
   IMPRESSÃO ACESSÍVEL
   ==================================== */

@media print {
  /* Remove elementos de navegação na impressão */
  nav,
  aside,
  [role="navigation"],
  [role="complementary"] {
    display: none;
  }

  /* Garante texto preto em fundo branco */
  body {
    background: white;
    color: black;
  }

  /* Remove sombras e efeitos visuais */
  * {
    box-shadow: none !important;
    text-shadow: none !important;
  }

  /* Links mostram URL */
  a[href]:after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    color: #666;
  }
}
